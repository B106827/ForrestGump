# ForrestGump  
位置情報(GoogleMapsAPI)を用いて近くの知らない人と対戦できるエアホッケーゲーム  
  
  
## 内容  
ユーザー登録後、近く(半径20m)でプレイ中のゲームルームが表示される。ない場合、自分でルームの作成も可能。  
その後ゲームルームに入室し、1対1のゲームが開催される。ルームには複数人入室可能でプレイヤー以外は観戦や参戦予約が可能。  
  
## URL  
https://b106827.sakura.ne.jp/work_08/register.html  
  
## jQuery  
  
register.html  
+ ユーザー登録ページ。ユーザー名の記録を行う。DBはFirebaseのリアルタイムデータベース(以下DB)を使用。すでに登録されているかどうかもチェックできる。  
  
login.html  
+ 57行目  
  + DBから作成されている全ルーム数取得。  
+ 72行目  
  + ユーザーの現在の経度緯度をGoogleMapsAPIを用いて取得。  
  + 各ゲームルームからの距離をヒュベニの公式(hubeny.js)を用いて算出。  
  + 半径20m以内なら各ゲームルームの一覧表示。入室可能となる。  
+ 168行目  
  + 入室すれば当該ユーザーの情報をDBに記録。  
+ 182行目  
  + 新たにルームを作成する場合の処理。ルームの基準位置はルーム作成者の位置となる。  
  
game.html  
+ 122行目  
  + 常にログインルームとの距離をDBに記録。もしユーザーが20m以上離れれば強制ログアウトとなる。  
+ 188行目  
  + エアホッケーゲームの処理。(CanvasとFirebase)  
  + 前回(https://github.com/B106827/Airhockey)  
    制作したホッケーゲームを常に、Firebaseのリアルタイムデータベースに記録するようにした。これによりオンラインでの対戦を実現した。  
+ 392行目  
  + 参加者と対戦相手、観戦者の区別  
+ 424行目  
  + 参戦予約機能。  
+ 454行目  
  + ルーム削除機能。ルームの作成者のみ機能する。  
+ 506行目  
  + ニコ動風コメント機能
